<!DOCTYPE html>


<head>
	<title>Fingerspelling</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<link rel="shortcut icon" type="image/png" href="logo.png"/>
	<link rel="stylesheet" href="examples.css">
	
	<style>
		small {
			display: block;
			padding-left: 2em !important;
			color: gray;
			text-decoration: none;
		}
		
		body {
			overflow: hidden;
		}
	</style>
</head>


<body>
	<header>
		<h1>Fingerspelling</h1>
		<h2>Random moras from the Japanese Sign Language</h2>
		<h3><a href="https://boytchev.github.io/virtual-robotics/">Virtual Robotics Examples</a></h3>
	</header>
	
	<script type="module">


	import * as Robotic from "../build/virtual-robotics.js";
	//import * as Robotic from "../src/virtual-robotics.js";
	

	var N = 20, // number of divs
		n = 0,	// current div
		divs = [];
		
	
	for( var i=0; i<N; i++ )
	{
		var div = document.createElement( 'DIV' );
		div.style = "width: 1em; height: 1.25em; position: absolute; color: black; text-align: center; font-size: 8em; font-weight: bold; padding:0; margin:0; font-family: sans-serif; opacity: 0; z-index: 100; bottom: 0.1em;";
		div.innerHTML = '<div style="font-size:0.25em; margin:0; padding:0; position:absolute; width:4em; font-weight:normal;">a</div>あ';
		divs.push( div );
		divs.speed = 1;
		document.body.appendChild(div);
	}
	
	var A = new Robotic.AnthroHand( true );
		
	
	var JSL = [
/*0*/	{ symbol: 'a',  hiragana: 'あ', rot: [0,0,0], angles: [1.34,-0.09,-0.5,0.05,-0.14,-0.22,-0.1,-1.57,-1.57,-1.57,-0.06,-1.57,-1.57,-1.57,0.02,-1.57,-1.57,-1.57,0.1,-1.57,-1.57,-1.57] },
		{ symbol: 'i',  hiragana: 'い', rot: [0,0,0], angles: [1.5,0.79,-0.33,-0.53,-1.57,-0.77,-0.1,-1.57,-1.57,-1.57,-0.06,-1.57,-1.57,-1.57,0.02,-1.57,-1.57,-1.57,0.1,-0.09,0,0] },
	
		{ symbol: 'u',  hiragana: 'う', rot: [0,0,0], angles: [1.26,0.54,-0.18,-0.69,-1.57,-0.36,0,-0.04,0,0,-0.06,-0.04,0,0,0.02,-1.57,-1.57,-1.57,0.1,-1.57,-1.57,-1.57] },
		{ symbol: 'e',  hiragana: 'え', rot: [0,0,0], angles: [0.68,0.13,-0.06,0.25,-1.57,-1.57,-0.09,-0.04,-1.57,-1.57,-0.06,-0.04,-1.57,-1.57,0.02,-0.04,-1.57,-1.57,0.1,-0.04,-1.57,-1.57] },
		{ symbol: 'o',  hiragana: 'お', rot: [0,1.57,0], angles: [1.26,1.18,0.13,-0.55,-0.9,-0.57,-0.27,-1.08,-0.83,-0.94,-0.12,-0.98,-0.93,-0.96,0.07,-1.03,-0.93,-0.93,0.32,-1.1,-0.96,-0.96] },

/*5*/	{ symbol: 'ka', hiragana: 'か', rot: [0,0.2,0], angles: [1.1,0,0.27,-0.83,-0.17,0,0.03,-0.2,-0.09,0,-0.13,-0.77,0,0,0.14,-1.57,-1.57,-0.39,0.2,-1.57,-1.57,-0.39] },
		{ symbol: 'ki', hiragana: 'き', rot: [0,0.1,0], angles: [1.34,1.53,0.22,-0.93,-0.17,0,0.03,-0.16,-0.09,0,0.12,-1.08,-1.13,0,0.1,-1.08,-1.04,-0.17,0.2,0.08,0,0] },
		{ symbol: 'ku', hiragana: 'く', rot: [0,3.14,-1.57], angles: [0,-0.45,1,0,0,0,0.06,-0.04,0,0,0,-0.04,0,0,-0.05,-0.04,0,0,-0.1,-0.04,0,0] },
		{ symbol: 'ke', hiragana: 'け', rot: [0,0,0], angles: [1.7,0.41,-0.11,-0.63,-1.57,-0.39,0.04,-0.04,0,0,-0.02,-0.04,0,0,-0.06,-0.04,0,0,-0.12,-0.04,0,0] },
		{ symbol: 'ko', hiragana: 'こ', rot: [0,1.57,-1], angles: [1.7,-0.17,-0.5,-0.63,-0.17,0,0.04,-1.57,0,0,-0.02,-1.57,0,0,-0.06,-1.57,0,0,-0.12,-1.57,0,0] },

/*10*/	{ symbol: 'sa', hiragana: 'さ', rot: [0,0,0], angles: [1.2,0.35,-0.18,-0.67,-1.24,-0.85,-0.08,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57,0.11,-1.57,-1.57,-1.57,0.19,-1.57,-1.57,-1.57] },
		{ symbol: 'shi',hiragana: 'し', rot: [0,3.14,-1.57], angles: [0,0,1,0.25,0,0,-0.18,-0.04,0,0,0.16,-0.04,0,0,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57] },
		{ symbol: 'su', hiragana: 'す', rot: [1,3.14,-3.14], angles: [0,0,1,0.25,0,0,-0.18,-0.86,0,0,0.16,-0.86,0,0,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57] },
		{ symbol: 'se', hiragana: 'せ', rot: [0,0,0], angles: [0.74,-0.01,0.06,-0.69,-0.79,-0.74,-0.16,-1.57,-1.57,-1.57,0,-0.04,0,0,0.19,-1.57,-1.57,-1.57,0.24,-1.57,-1.57,-1.57] },
		{ symbol: 'so', hiragana: 'そ', rot: [-1.3,1.3,0], angles: [0,-0.28,0.79,-0.59,-0.22,-1.41,0.14,-0.39,-0.11,-0.11,0.06,-1.57,-1.57,-1.57,0.11,-1.57,-1.57,-1.57,0.19,-1.57,-1.57,-1.57] },

/*15*/	{ symbol: 'ta', hiragana: 'た', rot: [-1.57,1.57,0], angles: [1.34,0.07,0.25,0.25,-0.14,-0.13,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57] },
		{ symbol: 'chi',hiragana: 'ち', rot: [0,1.57,0], angles: [1.34,1.53,0.37,-0.67,-0.6,0,-0.26,-1.15,-0.94,-0.05,-0.02,-1.05,-1.08,0,0.26,-1.08,-1.04,-0.17,0.2,0.08,0,0] },
		{ symbol: 'tsu',hiragana: 'つ', rot: [0,0,0], angles: [1.34,1.4,0.4,-0.61,-0.69,0,-0.26,-1.01,-0.94,-0.05,-0.02,-0.98,-1.08,0,0.26,-0.53,-0.27,-0.17,0.2,0.13,-0.28,0] },
		{ symbol: 'te', hiragana: 'て', rot: [0,0,0], angles: [0,-0.53,0.37,-0.11,-0.05,0,0.05,-0.04,0,0,0.01,-0.04,0,0,-0.03,-0.04,0,0,-0.06,-0.04,0,0] },
		{ symbol: 'to', hiragana: 'と', rot: [0,3.14,0], angles: [1.4,0.35,0.18,-1.07,-0.11,-0.57,0.03,-0.04,0,0,-0.02,-0.04,0,0,0.16,-1.57,-1.57,-1.57,0.34,-1.57,-1.57,-1.57] },

/*20*/	{ symbol: 'na', hiragana: 'な', rot: [1,3.14,-3.14], angles: [0.72,-0.04,0.42,-0.87,-0.69,0,-0.18,-0.86,0,0,0.16,-0.86,0,0,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57] },
		{ symbol: 'ni', hiragana: 'に', rot: [0,3.14,-1.57], angles: [0.72,-0.04,0.42,-0.87,-0.69,0,-0.13,-0.04,0,0,0.03,-0.04,0,0,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57] },
		{ symbol: 'nu', hiragana: 'ぬ', rot: [0,0.2,0], angles: [1.42,0.05,-0.47,-0.79,-0.97,-1.13,0,0.15,-1.3,-0.38,0,-1.05,-1.57,-1.57,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57] },
		{ symbol: 'ne', hiragana: 'ね', rot: [1,3.14,-3.14], angles: [0.72,0.27,0.2,-0.55,-0.11,-0.02,-0.01,-0.86,0,0,-0.02,-0.86,0,0,0,-0.86,0,0,0,-0.86,0,0] },
		{ symbol: 'no', hiragana: 'の', rot: [0,0,-0.8], angles: [1.32,0.63,0.19,-0.49,-0.55,-1.05,0,-0.39,-0.39,-0.39,0,-1.15,-1.29,-1.16,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57] },
		{ symbol: 'no', hiragana: 'の', rot: [0,3.14,-2.37], angles: [1.32,0.63,0.19,-0.49,-0.55,-1.05,0,-0.39,-0.39,-0.39,0,-1.15,-1.29,-1.16,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57] },

/*26*/	{ symbol: 'ha', hiragana: 'は', rot: [0,1.57,-1.57], angles: [1.54,0.02,-0.5,-0.67,-0.82,-1.3,-0.08,-0.39,0,0,0.15,-0.39,0,0,0.12,-1.57,-1.57,-1.57,0.22,-1.57,-1.57,-1.57] },
		{ symbol: 'hi', hiragana: 'ひ', rot: [0,0,0], angles: [1.52,0.49,-0.35,-0.75,-0.66,-0.82,0,-0.04,0,0,0,-0.96,-1.57,-1.57,0,-1.31,-1.57,-1.57,0.09,-1.57,-1.29,-1.57] },
		{ symbol: 'hu', hiragana: 'ふ', rot: [1,3.14,-3.14], angles: [0,-0.13,-0.03,0.03,0,0,0,-0.86,-0.11,-0.11,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57,0.09,-1.57,-1.57,-1.57] },
		{ symbol: 'he', hiragana: 'へ', rot: [1,3.14,-3.14], angles: [0,-0.13,-0.03,0.03,0,0,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57,-0.05,-0.91,-0.53,-0.19] },
		{ symbol: 'ho', hiragana: 'ほ', rot: [0,3.14,0], angles: [0,-0.13,0.77,0.25,-0.53,0,0.09,-0.51,0,0,0.03,-0.51,0,0,-0.02,-0.51,0,0,-0.08,-0.51,0,0] },

/*31*/	{ symbol: 'ma', hiragana: 'ま', rot: [1,3.14,-3.14], angles: [1.48,0.96,-0.22,-0.67,-0.79,-0.72,-0.14,-0.04,0,0,0,-0.04,0,0,0.13,-0.04,0,0,0.39,-1.57,-1.57,-1.57] },
		{ symbol: 'mi', hiragana: 'み', rot: [0,3.14,-1.57], angles: [1.48,0.96,-0.22,-0.67,-0.79,-0.72,-0.14,-0.04,0,0,0,-0.04,0,0,0.13,-0.04,0,0,0.39,-1.57,-1.57,-1.57] },
		{ symbol: 'mu', hiragana: 'む', rot: [0,3.14,-1.57], angles: [0.1,0.63,0.84,-0.05,0,0,-0.14,-0.04,0,0,0,-1.57,-1.57,-1.57,0.13,-1.57,-1.57,-1.57,0.39,-1.57,-1.57,-1.57] },
		{ symbol: 'me', hiragana: 'め', rot: [0,1.57,0], angles: [1.26,1.64,0.6,-0.43,-0.9,-0.57,-0.09,-1.08,-0.83,-0.94,-0.06,-0.2,-0.09,-0.09,-0.04,-0.2,-0.09,-0.09,0.32,-0.13,0,0] },
		{ symbol: 'mo', hiragana: 'も', rot: [-1.57,3.14,-0.5], angles: [1.98,1.2,0.77,-0.09,-0.39,-0.39,0,-0.68,-0.69,-0.85,0,-1.57,-1.57,-1.57,0.08,-1.57,-1.57,-1.57,0.16,-1.57,-1.57,-1.57] },
		{ symbol: 'mo', hiragana: 'も', rot: [-1.57,3.14,-0.5], angles: [1.62,1.2,0.77,0.25,-0.24,-0.28,0,-0.18,-0.24,-0.35,0,-1.57,-1.57,-1.57,0.08,-1.57,-1.57,-1.57,0.16,-1.57,-1.57,-1.57] },

/*37*/	{ symbol: 'ya', hiragana: 'や', rot: [0,0,0], angles: [0,0,1,0,-0.39,-0.39,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57,0,-1.57,-1.57,-1.57,0,-0.39,-0.39,-0.39] },
		{ symbol: 'yu', hiragana: 'ゆ', rot: [0,3.14,0], angles: [1.48,0.96,-0.22,-0.67,-0.79,-0.72,0.02,-0.04,0,0,0,-0.04,0,0,-0.02,-0.04,0,0,0.39,-1.57,-1.57,-1.57] },
		{ symbol: 'yo', hiragana: 'よ', rot: [0,3.14,-1.57], angles: [2,1.15,0.5,-0.93,-0.13,-0.19,0.1,-0.04,0,0,0.04,-0.04,0,0,-0.02,-0.04,0,0,-0.06,-0.04,0,0] },

/*40*/	{ symbol: 'ra', hiragana: 'ら', rot: [0,0,0], angles: [0.48,1.15,0.31,-1.63,-0.88,-0.86,0.11,-0.39,-0.24,-0.19,-0.38,0.01,-0.53,-0.58,0.16,-1.57,-1.57,-1.57,0.25,-1.57,-1.57,-0.79] },
		{ symbol: 'ri', hiragana: 'り', rot: [0,0,0], angles: [0.48,0.13,0.46,-1.05,-0.88,-0.85,-0.26,-0.06,-0.11,-0.13,0.01,-0.06,-0.13,-0.11,0.16,-1.57,-1.57,-1.57,0.25,-1.57,-1.57,-0.79] },
		{ symbol: 'ri', hiragana: 'り', rot: [3.14,0,0], angles: [0.48,0.13,0.46,-1.05,-0.88,-0.85,-0.26,-0.06,-0.11,-0.13,0.01,-0.06,-0.13,-0.11,0.16,-1.57,-1.57,-1.57,0.25,-1.57,-1.57,-0.79] },
		{ symbol: 'ru', hiragana: 'る', rot: [0,0,0], angles: [0.48,0.13,-0.09,-0.37,0,0,-0.26,-0.06,-0.11,-0.13,0.01,-0.06,-0.13,-0.11,0.16,-1.57,-1.57,-1.57,0.25,-1.57,-1.57,-0.79] },
		{ symbol: 're', hiragana: 'れ', rot: [0,0,0], angles: [0.48,0.13,-0.09,-0.37,0,0,-0.11,-0.06,-0.11,-0.13,0.08,-1.57,-1.57,-1.57,0.11,-1.57,-1.57,-1.57,0.14,-1.57,-1.57,-1.57] },
		{ symbol: 'ro', hiragana: 'ろ', rot: [0,0,0], angles: [0.48,0.13,0.46,-1.05,-0.88,-0.85,-0.4,-0.06,-0.86,-0.86,0.14,-0.06,-0.86,-0.86,0.16,-1.57,-1.57,-1.57,0.25,-1.57,-1.57,-0.79] },

/*46*/	{ symbol: 'wa', hiragana: 'わ', rot: [0,0,0], angles: [0.48,0.13,0.46,-1.05,-0.88,-0.85,-0.18,-0.06,0,0,0.03,-0.06,0,0,0.16,-0.04,0,0,0.25,-1.57,-1.57,-1.57] },
		{ symbol: 'wo', hiragana: 'を', rot: [0,1.57,0], angles: [1.26,1.18,0.13,-0.55,-0.9,-0.57,-0.27,-1.08,-0.83,-0.94,-0.12,-0.98,-0.93,-0.96,0.07,-1.03,-0.93,-0.93,0.32,-1.1,-0.96,-0.96] },

/*48*/	{ symbol: 'n',  hiragana: 'ん', rot: [0,2.37,-0.8], angles: [0,-0.28,0.79,-0.59,-0.22,-1.41,0.14,0.01,-0.11,-0.11,0.06,-1.57,-1.57,-1.57,0.11,-1.57,-1.57,-1.57,0.19,-1.57,-1.57,-1.57] },
		{ symbol: 'n',  hiragana: 'ん', rot: [-1.57,0,0], angles: [0,-0.28,0.79,-0.59,-0.22,-1.41,0.14,0.01,-0.11,-0.11,0.06,-1.57,-1.57,-1.57,0.11,-1.57,-1.57,-1.57,0.19,-1.57,-1.57,-1.57] },
		{ symbol: 'n',  hiragana: 'ん', rot: [0,0,-0.8], angles: [0,-0.28,0.79,-0.59,-0.22,-1.41,0.14,0.01,-0.11,-0.11,0.06,-1.57,-1.57,-1.57,0.11,-1.57,-1.57,-1.57,0.19,-1.57,-1.57,-1.57] },
	];

	//A.addGUI( 'Right hand' );

	Robotic.setCameraPosition( 0, 1.5, -10 );
	Robotic.setCameraTarget( 0, 1.5, 0 );
	Robotic.setAnimation( loop );



	function lerp( pose, a, b, k )
	{		
		for( var i=0; i<pose.length; i++ )
			pose[i] = a[i]*(1-k) + k*b[i];
	}


	var from = 0,
		to = Robotic.MathUtils.randInt( 0, JSL.length-1 ),
		time = 1,
		speed = 1.5,
		gap = 0.2;

	var neutral = A.getAngles(),
		pose = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		rot = [0,0,0];
		
	var box = new Robotic.Box3(),
		center = new Robotic.Vector3();

	function loop( t, dT )
	{
		time += dT;
		if( time > 1/speed )
		{
			from = to;
			while( from == to )
				to = Robotic.MathUtils.randInt( 0, JSL.length-1 );

			time = time % (1/speed);
		
			divs[n].innerHTML = '<div style="font-size:0.25em; margin:0; padding:0; position:absolute; width:4em; font-weight:normal; opacity: 1;">'+JSL[from].symbol+'</div>'+JSL[from].hiragana;
			divs[n].style.opacity = 1;
			divs[n].xpos = innerWidth/2-divs[n].clientWidth/2-50*(n%2-0.5);
			divs[n].style.left = divs[n].xpos + 'px';
			divs[n].style.opacity = 2;
			divs[n].style.filter = 'blur(0)';			
			divs[n].speed = 50;
			divs[n].dirx = 50;
			n = (n+1) % N;
		}
		
		var sgn = 1;
		for( var i=0; i<N; i++, sgn=-sgn )
		{
			divs[i].xpos += divs[i].speed*dT*sgn;
			divs[i].speed += 70*dT;
			divs[i].style.left = divs[i].xpos + 'px';
			divs[i].style.opacity *= 1-0.7*dT;
			if( divs[i].style.opacity < 0.5 )
			{
				divs[i].style.filter = 'blur('+(1-2*divs[i].style.opacity)+'em)';
			}
		}
		
		var k = Robotic.MathUtils.clamp( speed*((1+2*gap)*time-gap), 0, 1 );

		lerp( rot, JSL[from].rot, JSL[to].rot, k );
		lerp( pose, JSL[from].angles, JSL[to].angles, k );

		rot.x += Math.random()*0.6-0.3;
		rot.y += Math.random()*0.6-0.3;
		rot.z += Math.random()*0.6-0.3;

		A.setPosition( 0, 0, 0 );
		A.setAngles( ...pose );
		A.setRotation( ...rot );

		A.updateMatrix( );

		box.setFromObject( A, true );
		box.getCenter( center );
		A.setPosition( -center.x, 2-center.y, -center.z );
	}

	</script>
</body>
